<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WINTER SYSTEM v1.0 - –ü–£–°–¢–û–¢–ê</title>
    <style>
        @font-face {
            font-family: 'Perfect DOS VGA 437';
            src: url('https://fonts.cdnfonts.com/s/13936/Perfect_DOS_VGA_437_Win.woff') format('woff');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #0ff;
            font-family: 'Perfect DOS VGA 437', monospace;
            height: 100vh;
            overflow: hidden;
            cursor: default;
            position: relative;
        }

        #matrixCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.3;
        }

        #desktop {
            height: calc(100vh - 40px);
            padding: 20px;
            position: relative;
        }

        .window {
            position: absolute;
            background: #001122;
            border: 2px solid #00ffff;
            box-shadow: 0 0 20px #00ffff;
            min-width: 500px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            z-index: 100;
            resize: both;
            overflow: hidden;
        }

        .title-bar {
            background: linear-gradient(90deg, #001122, #003344);
            color: #0ff;
            padding: 5px 10px;
            border-bottom: 1px solid #00ffff;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }

        .title-bar-text {
            font-weight: bold;
            text-shadow: 0 0 10px #0ff;
        }

        .title-bar-controls button {
            background: #002233;
            border: 1px solid #00ffff;
            color: #0ff;
            padding: 2px 8px;
            margin-left: 5px;
            cursor: pointer;
            font-family: inherit;
        }

        .title-bar-controls button:hover {
            background: #004455;
        }

        .content {
            flex: 1;
            padding: 15px;
            background: #000511;
            color: #0ff;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            font-size: 14px;
            line-height: 1.4;
        }

        .content-terminal {
            flex: 1;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-bottom: 10px;
            border: 1px solid #003344;
            padding: 10px;
            background: #000811;
        }

        .content-input {
            background: #001122;
            border: 1px solid #00ffff;
            color: #0ff;
            padding: 8px;
            font-family: inherit;
            font-size: 14px;
            margin-top: 10px;
        }

        .content-input:focus {
            outline: none;
            box-shadow: 0 0 10px #00ffff;
        }

        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background: #001122;
            border-top: 2px solid #00ffff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
        }

        #start-button {
            background: #002233;
            border: 1px solid #00ffff;
            color: #0ff;
            padding: 5px 15px;
            cursor: pointer;
            font-family: inherit;
            margin-right: 20px;
        }

        #start-button:hover {
            background: #003344;
        }

        .start-menu {
            position: absolute;
            bottom: 40px;
            left: 0;
            background: #001122;
            border: 2px solid #00ffff;
            border-bottom: none;
            display: none;
            flex-direction: column;
            width: 250px;
            z-index: 1001;
        }

        .start-menu a {
            padding: 10px 15px;
            color: #0ff;
            text-decoration: none;
            border-bottom: 1px solid #003344;
        }

        .start-menu a:hover {
            background: #003344;
        }

        #system-clock {
            margin-left: auto;
            color: #0ff;
            font-size: 12px;
        }

        .desktop-icon {
            position: absolute;
            width: 80px;
            text-align: center;
            cursor: pointer;
            color: #0ff;
            text-shadow: 0 0 5px #0ff;
        }

        .desktop-icon:hover {
            color: #fff;
            text-shadow: 0 0 10px #fff;
        }

        .glitch {
            animation: glitch 2s infinite;
        }

        @keyframes glitch {
            0% { text-shadow: 2px 2px #f0f, -2px -2px #0ff; }
            20% { text-shadow: -2px -2px #f0f, 2px 2px #0ff; }
            40% { text-shadow: 2px -2px #f0f, -2px 2px #0ff; }
            60% { text-shadow: -2px 2px #f0f, 2px -2px #0ff; }
            80% { text-shadow: 2px 2px #f0f, -2px -2px #0ff; }
            100% { text-shadow: 2px 2px #f0f, -2px -2px #0ff; }
        }

        .flicker {
            animation: flicker 3s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
            51% { opacity: 0.2; }
            52% { opacity: 0.8; }
        }

        .snowflake {
            position: absolute;
            color: #aaf;
            font-size: 20px;
            user-select: none;
            pointer-events: none;
            z-index: -1;
        }

        .location-art {
            font-family: monospace;
            white-space: pre;
            text-align: center;
            margin: 10px 0;
            color: #0ff;
            text-shadow: 0 0 10px #0ff;
        }

        .inventory-item {
            background: #002233;
            border: 1px solid #00ffff;
            padding: 5px;
            margin: 2px;
            display: inline-block;
        }
    </style>
</head>
<body>

<canvas id="matrixCanvas"></canvas>

<div id="desktop">
    <div class="desktop-icon" style="top: 50px; left: 50px;" onclick="createWindow('–¢–ï–†–ú–ò–ù–ê–õ –ü–£–°–¢–û–¢–´', 'terminal')">
        <div style="font-size: 48px;">‚ùÑÔ∏è</div>
        <div>–¢–µ—Ä–º–∏–Ω–∞–ª</div>
    </div>
    
    <div class="desktop-icon" style="top: 50px; left: 150px;" onclick="createWindow('–ö–ê–†–¢–ê –°–û–ó–ù–ê–ù–ò–Ø', 'map')">
        <div style="font-size: 48px;">üó∫Ô∏è</div>
        <div>–ö–∞—Ä—Ç–∞</div>
    </div>
    
    <div class="desktop-icon" style="top: 50px; left: 250px;" onclick="createWindow('–ò–ù–í–ï–ù–¢–ê–†–¨', 'inventory')">
        <div style="font-size: 48px;">üéí</div>
        <div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
    </div>
    
    <div class="desktop-icon" style="top: 50px; left: 350px;" onclick="createWindow('–î–ù–ï–í–ù–ò–ö', 'diary')">
        <div style="font-size: 48px;">üìñ</div>
        <div>–î–Ω–µ–≤–Ω–∏–∫</div>
    </div>
</div>

<div class="taskbar">
    <div id="start-button">‚ùÑÔ∏è –°–ò–°–¢–ï–ú–ê</div>
    <div class="start-menu">
        <a href="#" onclick="createWindow('–¢–ï–†–ú–ò–ù–ê–õ –ü–£–°–¢–û–¢–´', 'terminal')">üíª –¢–µ—Ä–º–∏–Ω–∞–ª –ü—É—Å—Ç–æ—Ç—ã</a>
        <a href="#" onclick="createWindow('–ö–ê–†–¢–ê –°–û–ó–ù–ê–ù–ò–Ø', 'map')">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –°–æ–∑–Ω–∞–Ω–∏—è</a>
        <a href="#" onclick="createWindow('–ò–ù–í–ï–ù–¢–ê–†–¨', 'inventory')">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</a>
        <a href="#" onclick="createWindow('–î–ù–ï–í–ù–ò–ö', 'diary')">üìñ –î–Ω–µ–≤–Ω–∏–∫ –û–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞</a>
        <a href="#" onclick="createWindow('–°–ò–°–¢–ï–ú–ù–´–ô –ê–ù–ê–õ–ò–ó', 'system')">üîç –°–∏—Å—Ç–µ–º–Ω—ã–π –ê–Ω–∞–ª–∏–∑</a>
        <a href="#" onclick="createWindow('–ü–†–û–¢–û–ö–û–õ–´', 'protocols')">üì° –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –°–≤—è–∑–∏</a>
    </div>
    <div id="system-clock"></div>
</div>

<script>
    // ============================ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ============================
    const locations = [
        {
            name: "–ª–µ–¥—è–Ω–∞—è-–ø—É—Å—Ç–æ—Ç–∞",
            ascii: `
    ‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è
   ‚ùÑÔ∏è           ‚ùÑÔ∏è
  ‚ùÑÔ∏è             ‚ùÑÔ∏è
 ‚ùÑÔ∏è               ‚ùÑÔ∏è
‚ùÑÔ∏è                 ‚ùÑÔ∏è
 ‚ùÑÔ∏è               ‚ùÑÔ∏è
  ‚ùÑÔ∏è     üëÅÔ∏è     ‚ùÑÔ∏è
   ‚ùÑÔ∏è           ‚ùÑÔ∏è
    ‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è
            `,
            description: "–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ª–µ–¥—è–Ω–∞—è —Ä–∞–≤–Ω–∏–Ω–∞. –°–Ω–µ–≥ —Ö—Ä—É—Å—Ç–∏—Ç –ø–æ–¥ –Ω–æ–≥–∞–º–∏, –≤–µ—Ç–µ—Ä –≤—ã–µ—Ç –ø–µ—Å–Ω—å –∑–∞–±–≤–µ–Ω–∏—è. –ù–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ - –ª–∏—à—å –±–µ–ª–∏–∑–Ω–∞, —Å–ª–∏–≤–∞—é—â–∞—è—Å—è —Å –Ω–µ–±–æ–º. –•–æ–ª–æ–¥ –ø—Ä–æ–Ω–∏–∫–∞–µ—Ç –≤ –∫–æ—Å—Ç–∏, –Ω–æ —Ç—ã —É–∂–µ –Ω–µ —á—É–≤—Å—Ç–≤—É–µ—à—å –µ–≥–æ. –¢—ã —á–∞—Å—Ç—å —ç—Ç–æ–π –ø—É—Å—Ç–æ—Ç—ã.",
            items: ["–ª–µ–¥—è–Ω–æ–π-–æ—Å–∫–æ–ª–æ–∫", "–∑–∞–º–µ—Ä–∑—à–∞—è-—Å–ª–µ–∑–∞"],
            itemsDescription: [
                "–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –æ—Å–∫–æ–ª–æ–∫ –ª—å–¥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –∑–∞—Å—Ç—ã–ª–∏ –º–∏–ª–ª–∏–æ–Ω—ã –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤. –ï—Å–ª–∏ –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è, –≤ –Ω–∏—Ö –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–µ —Ç–≤–æ–µ –ª–∏—Ü–æ, –∞ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ...",
                "–ö—Ä–æ—à–µ—á–Ω–∞—è –ª–µ–¥—è–Ω–∞—è —Å—Ñ–µ—Ä–∞. –í–Ω—É—Ç—Ä–∏ –±—É–¥—Ç–æ –∑–∞—Å—Ç—ã–ª–æ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —á–µ–º-—Ç–æ —Ç–µ–ø–ª–æ–º, —á–µ–≥–æ –±–æ–ª—å—à–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç."
            ],
            exits: ["–ª–µ–¥—è–Ω–∞—è-–ø—É—Å—Ç–æ—Ç–∞", "–∑–∞–±—Ä–æ—à–µ–Ω–Ω–∞—è-–æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è", "–ª–µ—Å-–∑–∞–±–≤–µ–Ω–∏—è"]
        },
        {
            name: "–∑–∞–±—Ä–æ—à–µ–Ω–Ω–∞—è-–æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è",
            ascii: `
     üî≠=======
    /        \\
   /          \\
  /    ‚ö´      \\
 /              \\
/________________\\
     |      |
     |      |
            `,
            description: "–ö—É–ø–æ–ª –æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏–∏ –ø—Ä–æ–ª–æ–º–ª–µ–Ω, —Ç–µ–ª–µ—Å–∫–æ–ø—ã —Å–º–æ—Ç—Ä—è—Ç –≤ –º–µ—Ä—Ç–≤–æ–µ –Ω–µ–±–æ. –ó–≤–µ–∑–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –∫–æ–≥–¥–∞-—Ç–æ –Ω–∞–±–ª—é–¥–∞–ª–∏, –¥–∞–≤–Ω–æ –ø–æ–≥–∞—Å–ª–∏. –ù–∞ —Å—Ç–æ–ª–µ - –ø—ã–ª—å–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã —Å –∑–∞–ø–∏—Å—è–º–∏ –æ '–ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–Ω—è—Ö'.",
            items: ["—Å–ª–æ–º–∞–Ω–Ω—ã–π-—Ç–µ–ª–µ—Å–∫–æ–ø", "–¥–Ω–µ–≤–Ω–∏–∫-–∞—Å—Ç—Ä–æ–Ω–æ–º–∞"],
            itemsDescription: [
                "–û–ø—Ç–∏–∫–∞ —Ä–∞–∑–±–∏—Ç–∞, –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—Ä–∂–∞–≤–µ–ª–∏. –ù–æ –µ—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–≥–æ, –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–µ –∑–≤–µ–∑–¥—ã, –∞ —É–∑–æ—Ä—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç—á–∞—è–Ω–∏—è.",
                "–°—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–∂–µ–ª—Ç–µ–ª–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏. –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å: '–ù–µ–±–µ—Å–∞ –ø—É—Å—Ç—ã. –ë–æ–≥–∏ —É–º–µ—Ä–ª–∏. –ú—ã –æ–¥–Ω–∏. –ù–∞–≤—Å–µ–≥–¥–∞.'"
            ],
            exits: ["–ª–µ–¥—è–Ω–∞—è-–ø—É—Å—Ç–æ—Ç–∞", "–∑–∞–±—Ä–æ—à–µ–Ω–Ω–∞—è-–æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è", "–ø–æ–¥–≤–∞–ª-–ø–∞–º—è—Ç–∏"]
        },
        {
            name: "–ª–µ—Å-–∑–∞–±–≤–µ–Ω–∏—è",
            ascii: `
    üå≤    üå≤    üå≤
      \\   |   /
       \\  |  /
    üå≤  \\ | /  üå≤
        \\|/
    ----üíÄ----
        /|\\
    üå≤  / | \\  üå≤
       /  |  \\
      /   |   \\
    üå≤    üå≤    üå≤
            `,
            description: "–î–µ—Ä–µ–≤—å—è —Å—Ç–æ—è—Ç –∫–∞–∫ –∑–∞—Å—Ç—ã–≤—à–∏–µ –ø—Ä–∏–∑—Ä–∞–∫–∏. –ò—Ö –≤–µ—Ç–≤–∏ - –∫–æ—Å—Ç–∏, –ø—Ä–æ—Ç—è–Ω—É—Ç—ã–µ –∫ —Å–µ—Ä–æ–º—É –Ω–µ–±—É. –í–æ–∑–¥—É—Ö –ø–∞—Ö–Ω–µ—Ç —Ç–ª–µ–Ω–∏–µ–º –∏ –∑–∞–±—ã—Ç—ã–º–∏ –æ–±–µ—â–∞–Ω–∏—è–º–∏. –®–µ–ø–æ—Ç –º–µ–∂–¥—É –¥–µ—Ä–µ–≤—å—è–º–∏ - —ç—Ç–æ –Ω–µ –≤–µ—Ç–µ—Ä, –∞ —ç—Ö–æ —Ç–≤–æ–∏—Ö –º—ã—Å–ª–µ–π.",
            items: ["–æ–∫–∞–º–µ–Ω–µ–≤—à–∏–π-–ª–∏—Å—Ç", "—à–µ–ø–æ—Ç-–≤–µ—Ç—Ä–∞"],
            itemsDescription: [
                "–õ–∏—Å—Ç, –ø—Ä–µ–≤—Ä–∞—Ç–∏–≤—à–∏–π—Å—è –≤ –∫–∞–º–µ–Ω—å. –ù–∞ –Ω–µ–º –≤—ã—Ä–µ–∑–∞–Ω—ã —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –∫–æ–≥–¥–∞-—Ç–æ —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å, –Ω–æ –Ω–µ —Å–º–æ–≥.",
                "–ù–µ –ø—Ä–µ–¥–º–µ—Ç, –∞ –∑–≤—É–∫. –ï—Å–ª–∏ –ø—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è, –æ–Ω –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ç–≤–æ–∏ —Å–∞–º—ã–µ —Ç–µ–º–Ω—ã–µ –º—ã—Å–ª–∏."
            ],
            exits: ["–ª–µ–¥—è–Ω–∞—è-–ø—É—Å—Ç–æ—Ç–∞", "–ª–µ—Å-–∑–∞–±–≤–µ–Ω–∏—è", "–æ–∑–µ—Ä–æ-–æ—Ç—Ä–∞–∂–µ–Ω–∏–π"]
        },
        {
            name: "–æ–∑–µ—Ä–æ-–æ—Ç—Ä–∞–∂–µ–Ω–∏–π",
            ascii: `
    ~~~~~~~~~~~
   ~           ~
  ~     üíß      ~
 ~               ~
~      üîÑ        ~
 ~               ~
  ~             ~
   ~           ~
    ~~~~~~~~~~~
            `,
            description: "–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –æ–∑–µ—Ä–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø–æ–¥–≤–∏–∂–Ω–∞. –í–æ–¥–∞ —á–µ—Ä–Ω–∞—è –∫–∞–∫ –Ω–æ—á—å. –ö–æ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—à—å –≤ –Ω–µ–µ, –≤–∏–¥–∏—à—å –Ω–µ —Å–≤–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ, –∞ –≤—Å–µ –≤–µ—Ä—Å–∏–∏ —Å–µ–±—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å. –ò –≤—Å–µ –æ–Ω–∏ —Ç–∞–∫ –∂–µ –æ–¥–∏–Ω–æ–∫–∏.",
            items: ["—á–µ—Ä–Ω–∞—è-–≤–æ–¥–∞", "–∏—Å–∫–∞–∂–µ–Ω–Ω–æ–µ-–æ—Ç—Ä–∞–∂–µ–Ω–∏–µ"],
            itemsDescription: [
                "–ñ–∏–¥–∫–∞—è —Ç—å–º–∞. –•–æ–ª–æ–¥–Ω–∞—è –∏ —Ç—è–∂–µ–ª–∞—è. –í –Ω–µ–π —Ä–∞—Å—Ç–≤–æ—Ä—è—é—Ç—Å—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è.",
                "–¢—ã –≤–∏–¥–∏—à—å —Å–µ–±—è, –Ω–æ –Ω–µ —Ç–æ–≥–æ, –∫–µ–º —Å—Ç–∞–ª. –¢–æ–≥–æ, –∫–µ–º –º–æ–≥ –±—ã —Å—Ç–∞—Ç—å. –ò —ç—Ç–æ –±–æ–ª—å–Ω–µ–µ –ª—é–±–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏."
            ],
            exits: ["–ª–µ—Å-–∑–∞–±–≤–µ–Ω–∏—è", "–æ–∑–µ—Ä–æ-–æ—Ç—Ä–∞–∂–µ–Ω–∏–π", "—Ä—É–∏–Ω—ã-–≥–æ—Ä–æ–¥–∞"]
        },
        {
            name: "—Ä—É–∏–Ω—ã-–≥–æ—Ä–æ–¥–∞",
            ascii: `
    üè¢üí•üè¢
   /       \\
  üè¢  üöó  üè¢
 /         \\
üè¢   üö∂   üè¢
 \\         /
  üè¢     üè¢
   \\___/
            `,
            description: "–ù–µ–±–æ—Å–∫—Ä–µ–±—ã-—Å–∫–µ–ª–µ—Ç—ã –ø—Ä–æ–Ω–∑–∞—é—Ç –Ω–µ–±–æ. –£–ª–∏—Ü—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Ç–∏—à–∏–Ω–æ–π, –∫–æ—Ç–æ—Ä–∞—è –∑–≤–µ–Ω–∏—Ç –≤ —É—à–∞—Ö. –†–µ–∫–ª–∞–º–Ω—ã–µ —â–∏—Ç—ã –æ–±–µ—â–∞—é—Ç —Å—á–∞—Å—Ç—å–µ, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–æ. –¢—ã –∏–¥–µ—à—å –ø–æ –≥–æ—Ä–æ–¥—É-–ø—Ä–∏–∑—Ä–∞–∫—É, –∏ —Ç–≤–æ–∏ —à–∞–≥–∏ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–≤—É–∫.",
            items: ["—Ä–∞–∑–±–∏—Ç—ã–π-—Å–º–∞—Ä—Ç—Ñ–æ–Ω", "–≤—ã—Ü–≤–µ—Ç—à–∞—è-—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è"],
            itemsDescription: [
                "–≠–∫—Ä–∞–Ω —Ç—Ä–µ—Å–Ω—É–ª, –±–∞—Ç–∞—Ä–µ—è –º–µ—Ä—Ç–≤–∞. –í –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏: '–Ø —Ç–µ–±—è –ª—é–±–ª—é'. –û—Ç–≤–µ—Ç–∞ –Ω–µ—Ç.",
                "–õ–∏—Ü–∞ —Ä–∞–∑–º—ã—Ç—ã –≤—Ä–µ–º–µ–Ω–µ–º. –¢—ã –ø–æ–º–Ω–∏—à—å –∏—Ö, –Ω–æ –Ω–µ –ø–æ–º–Ω–∏—à—å, –∫–µ–º –æ–Ω–∏ —Ç–µ–±–µ –±—ã–ª–∏."
            ],
            exits: ["–æ–∑–µ—Ä–æ-–æ—Ç—Ä–∞–∂–µ–Ω–∏–π", "—Ä—É–∏–Ω—ã-–≥–æ—Ä–æ–¥–∞", "—Å—Ç–∞–Ω—Ü–∏—è-–º–µ—Ç—Ä–æ"]
        },
        {
            name: "—Å—Ç–∞–Ω—Ü–∏—è-–º–µ—Ç—Ä–æ",
            ascii: `
    _____________
   |  üöá  üöá  üöá |
   |_____________|
   |             |
   |     ‚è≥      |
   |             |
   |_____üö∂______|
            `,
            description: "–ü–æ–µ–∑–¥–∞ —Å—Ç–æ—è—Ç –Ω–∞ –≤–µ—á–Ω–æ–π —Å—Ç–æ—è–Ω–∫–µ. –†–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å. –í —Ç–æ–Ω–Ω–µ–ª—è—Ö - —Ç–µ–º–Ω–æ—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –º–∞–Ω–∏—Ç –∏ –ø—É–≥–∞–µ—Ç. –í–æ–∑–¥—É—Ö –ø–∞—Ö–Ω–µ—Ç –æ–∑–æ–Ω–æ–º –∏ –æ—Ç—á–∞—è–Ω–∏–µ–º.",
            items: ["–ø—Ä–æ–µ–∑–¥–Ω–æ–π-–±–∏–ª–µ—Ç", "—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–∏–∑—Ä–∞–∫–æ–≤"],
            itemsDescription: [
                "–ë–∏–ª–µ—Ç –≤ –Ω–∏–∫—É–¥–∞. –î–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: '–∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å'. –≠—Ç–æ –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –Ω–∞—Å—Ç—É–ø–∏—Ç.",
                "–ü–æ–µ–∑–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏–¥—É—Ç. –ö–∞–∫ –∏ –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –∂–¥–µ—à—å."
            ],
            exits: ["—Ä—É–∏–Ω—ã-–≥–æ—Ä–æ–¥–∞", "—Å—Ç–∞–Ω—Ü–∏—è-–º–µ—Ç—Ä–æ", "–ø–æ–¥–≤–∞–ª-–ø–∞–º—è—Ç–∏"]
        },
        {
            name: "–ø–æ–¥–≤–∞–ª-–ø–∞–º—è—Ç–∏",
            ascii: `
    üö™======
   |        |
   |  üíÄ    |
   |  /|\\   |
   |  / \\   |
   |________|
            `,
            description: "–ó–¥–µ—Å—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å–µ, —á—Ç–æ —Ç—ã –ø—ã—Ç–∞–ª—Å—è –∑–∞–±—ã—Ç—å. –°—Ç–∞—Ä—ã–µ –æ–±–∏–¥—ã, –Ω–µ—Å–±—ã–≤—à–∏–µ—Å—è –º–µ—á—Ç—ã, —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω—è—Ç –¥–æ —Å–∏—Ö –ø–æ—Ä. –°—Ç–µ–Ω—ã —à–µ–ø—á—É—Ç —Ç–≤–æ–∏–º–∏ –≥–æ–ª–æ—Å–∞–º–∏ - –≤—Å–µ–º–∏, –∫–∞–∫–∏–º–∏ —Ç—ã –∫–æ–≥–¥–∞-–ª–∏–±–æ –±—ã–ª.",
            items: ["–∑–∞–±—ã—Ç—ã–π-—Å—Ç—Ä–∞—Ö", "–æ–∫–∞–º–µ–Ω–µ–≤—à–∞—è-–Ω–∞–¥–µ–∂–¥–∞"],
            itemsDescription: [
                "–û–Ω –ª–µ–≥–∫–∏–π –∫–∞–∫ –ø—É—Ö, –Ω–æ –¥–∞–≤–∏—Ç —Ç—è–∂–µ–ª–µ–µ —Å–≤–∏–Ω—Ü–∞. –¢—ã –Ω–æ—Å–∏—à—å –µ–≥–æ —Å —Å–æ–±–æ–π –≤—Å–µ–≥–¥–∞.",
                "–ö–æ–≥–¥–∞-—Ç–æ –æ–Ω–∞ –±—ã–ª–∞ —Ç–µ–ø–ª–æ–π. –¢–µ–ø–µ—Ä—å —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ö–æ–ª–æ–¥–Ω—ã–π –∫–∞–º–µ–Ω—å."
            ],
            exits: ["–∑–∞–±—Ä–æ—à–µ–Ω–Ω–∞—è-–æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è", "—Å—Ç–∞–Ω—Ü–∏—è-–º–µ—Ç—Ä–æ", "–ø–æ–¥–≤–∞–ª-–ø–∞–º—è—Ç–∏", "–∫–æ–º–Ω–∞—Ç–∞-–æ—Å–æ–∑–Ω–∞–Ω–∏—è"]
        },
        {
            name: "–∫–æ–º–Ω–∞—Ç–∞-–æ—Å–æ–∑–Ω–∞–Ω–∏—è",
            ascii: `
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë         ‚ïë
    ‚ïë    üí°   ‚ïë
    ‚ïë    ü™û   ‚ïë
    ‚ïë         ‚ïë
    ‚ïë    üö∂   ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            `,
            description: "–ö–æ–º–Ω–∞—Ç–∞ –±–µ–∑ –¥–≤–µ—Ä–µ–π. –í —Ü–µ–Ω—Ç—Ä–µ - –∑–µ—Ä–∫–∞–ª–æ. –í –Ω–µ–º —Ç—ã –≤–∏–¥–∏—à—å –ø—Ä–∞–≤–¥—É: —Ç—ã –Ω–µ –∑–∞—Å—Ç—Ä—è–ª –∑–¥–µ—Å—å. –¢—ã —Å–æ–∑–¥–∞–ª —ç—Ç–æ –º–µ—Å—Ç–æ. –≠—Ç–∞ –ø—É—Å—Ç–æ—Ç–∞ - —Ç–≤–æ–µ —Ç–≤–æ—Ä–µ–Ω–∏–µ, —Ç–≤–æ–µ —É–±–µ–∂–∏—â–µ –æ—Ç –º–∏—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—á–∏–Ω—è–ª –±–æ–ª—å.",
            items: ["–∫–ª—é—á-–æ—Å–æ–∑–Ω–∞–Ω–∏—è"],
            itemsDescription: [
                "–û–Ω –æ—Ç–ø–∏—Ä–∞–µ—Ç –¥–≤–µ—Ä—å, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç. –í–µ–¥–µ—Ç –∫ –≤—ã—Ö–æ–¥—É, –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è. –ü–æ—Ç–æ–º—É —á—Ç–æ –∑–∞ –Ω–∏–º - —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å. –ê —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—à–Ω–µ–µ –ª—é–±–æ–π –ø—É—Å—Ç–æ—Ç—ã."
            ],
            exits: ["–ø–æ–¥–≤–∞–ª-–ø–∞–º—è—Ç–∏", "–∫–æ–º–Ω–∞—Ç–∞-–æ—Å–æ–∑–Ω–∞–Ω–∏—è"]
        }
    ];

    let currentLocation = "–ª–µ–¥—è–Ω–∞—è-–ø—É—Å—Ç–æ—Ç–∞";
    let inventory = [];
    let diaryEntries = [];
    let systemLogs = [];
    let windowCounter = 0;

    // ============================ –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò ============================
    function getLocationByName(name) {
        return locations.find(loc => loc.name === name);
    }

    function getCurrentLocation() {
        return getLocationByName(currentLocation);
    }

    function canMoveTo(locationName) {
        return getCurrentLocation().exits.includes(locationName);
    }

    function moveTo(locationName) {
        if (canMoveTo(locationName)) {
            currentLocation = locationName;
            addDiaryEntry(`–ü–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –≤: ${locationName}`);
            addSystemLog(`LOCATION_CHANGE: ${locationName}`);
            return true;
        }
        return false;
    }

    function takeItem(itemName) {
        const location = getCurrentLocation();
        const itemIndex = location.items.indexOf(itemName);
        
        if (itemIndex !== -1 && !inventory.includes(itemName)) {
            inventory.push(itemName);
            addDiaryEntry(`–ü–æ–¥–æ–±—Ä–∞–ª: ${itemName}`);
            addSystemLog(`ITEM_ACQUIRED: ${itemName}`);
            return true;
        }
        return false;
    }

    function getItemDescription(itemName) {
        for (let location of locations) {
            const itemIndex = location.items.indexOf(itemName);
            if (itemIndex !== -1) {
                return location.itemsDescription[itemIndex];
            }
        }
        return "–ü—Ä–µ–¥–º–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–∞–º—è—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.";
    }

    // ============================ –°–ò–°–¢–ï–ú–ê –ñ–£–†–ù–ê–õ–û–í ============================
    function addDiaryEntry(entry) {
        const timestamp = new Date().toLocaleTimeString();
        diaryEntries.push(`[${timestamp}] ${entry}`);
        if (diaryEntries.length > 50) diaryEntries.shift();
    }

    function addSystemLog(log) {
        const timestamp = new Date().toLocaleTimeString();
        systemLogs.push(`[${timestamp}] ${log}`);
        if (systemLogs.length > 100) systemLogs.shift();
    }

    // ============================ –í–ò–ó–£–ê–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ ============================
    function createSnowflakes() {
        const snowContainer = document.createElement('div');
        snowContainer.style.position = 'fixed';
        snowContainer.style.top = '0';
        snowContainer.style.left = '0';
        snowContainer.style.width = '100%';
        snowContainer.style.height = '100%';
        snowContainer.style.pointerEvents = 'none';
        snowContainer.style.zIndex = '9999';
        document.body.appendChild(snowContainer);

        for (let i = 0; i < 50; i++) {
            createSnowflake(snowContainer);
        }
    }

    function createSnowflake(container) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.innerHTML = '‚ùÑ';
        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.animationDuration = (Math.random() * 10 + 5) + 's';
        snowflake.style.opacity = Math.random() * 0.7 + 0.3;
        container.appendChild(snowflake);

        setTimeout(() => {
            snowflake.remove();
            createSnowflake(container);
        }, 15000);
    }

    function initMatrix() {
        const canvas = document.getElementById('matrixCanvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const chars = "01010101010101010101010101010101";
        const charSize = 14;
        const columns = canvas.width / charSize;
        const drops = Array(Math.floor(columns)).fill(1);
        
        function draw() {
            ctx.fillStyle = 'rgba(0, 5, 17, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#0ff';
            ctx.font = charSize + 'px monospace';
            
            for (let i = 0; i < drops.length; i++) {
                const text = chars[Math.floor(Math.random() * chars.length)];
                ctx.fillText(text, i * charSize, drops[i] * charSize);
                
                if (drops[i] * charSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }
        
        setInterval(draw, 33);
    }

    // ============================ –°–ò–°–¢–ï–ú–ê –û–ö–û–ù ============================
    function createWindow(title, type) {
        const windowDiv = document.createElement('div');
        windowDiv.className = 'window flicker';
        windowDiv.style.left = `${50 + (windowCounter * 30)}px`;
        windowDiv.style.top = `${50 + (windowCounter * 30)}px`;
        windowCounter++;
        
        windowDiv.innerHTML = `
            <div class="title-bar">
                <div class="title-bar-text">‚ùÑÔ∏è ${title}</div>
                <div class="title-bar-controls">
                    <button onclick="this.closest('.window').style.display='none';">_</button>
                    <button onclick="this.closest('.window').classList.toggle('maximized')">‚ñ°</button>
                    <button onclick="this.closest('.window').remove()">X</button>
                </div>
            </div>
            <div class="content"></div>
        `;
        
        const content = windowDiv.querySelector('.content');
        
        switch(type) {
            case 'terminal':
                initTerminal(content);
                break;
            case 'map':
                initMap(content);
                break;
            case 'inventory':
                initInventory(content);
                break;
            case 'diary':
                initDiary(content);
                break;
            case 'system':
                initSystem(content);
                break;
            case 'protocols':
                initProtocols(content);
                break;
        }
        
        document.getElementById('desktop').appendChild(windowDiv);
        makeDraggable(windowDiv);
        return windowDiv;
    }

    function makeDraggable(element) {
        const titleBar = element.querySelector('.title-bar');
        let isDragging = false;
        let offsetX, offsetY;
        
        titleBar.addEventListener('mousedown', (e) => {
            isDragging = true;
            offsetX = e.clientX - element.offsetLeft;
            offsetY = e.clientY - element.offsetTop;
            element.style.zIndex = getHighestZIndex() + 1;
        });
        
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                element.style.left = (e.clientX - offsetX) + 'px';
                element.style.top = (e.clientY - offsetY) + 'px';
            }
        });
        
        document.addEventListener('mouseup', () => {
            isDragging = false;
        });
    }
    
    function getHighestZIndex() {
        return Array.from(document.querySelectorAll('.window'))
            .map(w => parseInt(getComputedStyle(w).zIndex))
            .filter(z => !isNaN(z))
            .reduce((max, z) => Math.max(max, z), 0);
    }

    // ============================ –ú–û–î–£–õ–ò –û–ö–û–ù ============================
    function initTerminal(container) {
        const location = getCurrentLocation();
        
        container.innerHTML = `
            <div class="content-terminal">
WINTER SYSTEM v1.0 - –¢–ï–†–ú–ò–ù–ê–õ –ü–£–°–¢–û–¢–´
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–¢–µ–∫—É—â–∞—è –ª–æ–∫–∞—Ü–∏—è: ${location.name}
${location.ascii}

${location.description}

–î–æ—Å—Ç—É–ø–Ω—ã–µ –≤—ã—Ö–æ–¥—ã: ${location.exits.join(', ')}

–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: ${inventory.length > 0 ? inventory.join(', ') : '–ø—É—Å—Ç–æ'}

–ö–æ–º–∞–Ω–¥—ã:
‚Ä¢ –æ—Å–º–æ—Ç—Ä–µ—Ç—å [–ª–æ–∫–∞—Ü–∏—è/–ø—Ä–µ–¥–º–µ—Ç]
‚Ä¢ –∏–¥—Ç–∏ [–ª–æ–∫–∞—Ü–∏—è] 
‚Ä¢ –≤–∑—è—Ç—å [–ø—Ä–µ–¥–º–µ—Ç]
‚Ä¢ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
‚Ä¢ –ø–æ–º–æ—â—å
‚Ä¢ —Å–∏—Å—Ç–µ–º–∞

>_
            </div>
            <input class="content-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É..." />
        `;
        
        const input = container.querySelector('input');
        const output = container.querySelector('.content-terminal');
        
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                processCommand(input.value, output);
                input.value = '';
            }
        });
    }

    function initMap(container) {
        let mapContent = "üó∫Ô∏è –ö–ê–†–¢–ê –°–û–ó–ù–ê–ù–ò–Ø\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
        
        locations.forEach(loc => {
            const isCurrent = loc.name === currentLocation;
            mapContent += `${isCurrent ? 'üìç ' : '  '}${loc.name}\n`;
        });
        
        mapContent += `\n–í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å: ${currentLocation}`;
        
        container.innerHTML = `
            <div class="content-terminal">${mapContent}</div>
            <div class="location-art">${getCurrentLocation().ascii}</div>
        `;
    }

    function initInventory(container) {
        let invContent = "üéí –ò–ù–í–ï–ù–¢–ê–†–¨\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
        
        if (inventory.length === 0) {
            invContent += "–ü—É—Å—Ç–æ—Ç–∞... –ö–∞–∫ –∏ –≤–µ–∑–¥–µ.\n";
        } else {
            inventory.forEach(item => {
                invContent += `‚Ä¢ ${item}\n`;
            });
        }
        
        container.innerHTML = `
            <div class="content-terminal">${invContent}</div>
            <div style="margin-top: 10px;">
                <button onclick="createWindow('–ü–†–û–°–ú–û–¢–† –ü–†–ï–î–ú–ï–¢–ê', 'item_view')" 
                        style="background: #002233; border: 1px solid #00ffff; color: #0ff; padding: 5px 10px; font-family: inherit;">
                    –û—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥–º–µ—Ç
                </button>
            </div>
        `;
    }

    function initDiary(container) {
        let diaryContent = "üìñ –î–ù–ï–í–ù–ò–ö –û–î–ò–ù–û–ß–ï–°–¢–í–ê\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
        
        if (diaryEntries.length === 0) {
            diaryContent += "–°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—É—Å—Ç—ã. –ö–∞–∫ –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.\n";
        } else {
            diaryEntries.slice().reverse().forEach(entry => {
                diaryContent += `${entry}\n\n`;
            });
        }
        
        container.innerHTML = `<div class="content-terminal">${diaryContent}</div>`;
    }

    function initSystem(container) {
        let systemContent = "üîç –°–ò–°–¢–ï–ú–ù–´–ô –ê–ù–ê–õ–ò–ó\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
        
        systemContent += `–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã: WINTER v1.0\n`;
        systemContent += `–°–æ—Å—Ç–æ—è–Ω–∏–µ: ${inventory.length > 5 ? '–°–¢–ê–ë–ò–õ–¨–ù–û' : '–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï'}\n`;
        systemContent += `–õ–æ–∫–∞—Ü–∏–π –≤ –ø–∞–º—è—Ç–∏: ${locations.length}\n`;
        systemContent += `–ü—Ä–µ–¥–º–µ—Ç–æ–≤ —Å–æ–±—Ä–∞–Ω–æ: ${inventory.length}\n`;
        systemContent += `–ó–∞–ø–∏—Å–µ–π –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ: ${diaryEntries.length}\n\n`;
        
        systemContent += "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:\n";
        systemLogs.slice(-10).reverse().forEach(log => {
            systemContent += `${log}\n`;
        });
        
        container.innerHTML = `<div class="content-terminal">${systemContent}</div>`;
    }

    function initProtocols(container) {
        const protocols = `
üì° –ü–†–û–¢–û–ö–û–õ–´ –°–í–Ø–ó–ò
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ü—Ä–æ—Ç–æ–∫–æ–ª –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞: –ê–ö–¢–ò–í–ï–ù
–ü—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞–¥–µ–∂–¥—ã: –û–¢–ö–õ–Æ–ß–ï–ù
–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–∞–º—è—Ç–∏: –ü–û–í–†–ï–ñ–î–ï–ù
–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: –ù–ï–î–û–°–¢–£–ü–ï–ù

–ü–æ–ø—ã—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑—å...
[====================] 0%

–°–∏–≥–Ω–∞–ª –ø–æ—Ç–µ—Ä—è–Ω –≤ –±–µ–ª–æ–º —à—É–º–µ.
–ö–∞–∫ –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.

"–ò–Ω–æ–≥–¥–∞ —Ç–∏—à–∏–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –≥—Ä–æ–º—á–µ —Å–ª–æ–≤.
–ù–æ —á—Ç–æ –æ–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç, –∫–æ–≥–¥–∞ —Å–ª–æ–≤ –Ω–µ—Ç?"
        `;
        
        container.innerHTML = `<div class="content-terminal glitch">${protocols}</div>`;
    }

    // ============================ –û–ë–†–ê–ë–û–¢–ö–ê –ö–û–ú–ê–ù–î ============================
    function processCommand(command, output) {
        const cmd = command.toLowerCase().trim();
        const args = cmd.split(' ');
        const mainCmd = args[0];
        
        output.innerHTML += `> ${command}\n`;
        
        switch(mainCmd) {
            case '–æ—Å–º–æ—Ç—Ä–µ—Ç—å':
                if (args[1]) {
                    if (args[1] === currentLocation) {
                        output.innerHTML += `${getCurrentLocation().description}\n`;
                    } else if (inventory.includes(args[1])) {
                        output.innerHTML += `${getItemDescription(args[1])}\n`;
                    } else {
                        output.innerHTML += `–ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ '${args[1]}' –¥–ª—è –æ—Å–º–æ—Ç—Ä–∞.\n`;
                    }
                } else {
                    output.innerHTML += "–£–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –æ—Å–º–æ—Ç—Ä–µ—Ç—å.\n";
                }
                break;
                
            case '–∏–¥—Ç–∏':
                if (args[1]) {
                    if (moveTo(args[1])) {
                        output.innerHTML += `–ü–µ—Ä–µ–º–µ—â–∞—é—Å—å –≤ ${args[1]}...\n`;
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª
                        setTimeout(() => {
                            const terminalWindow = document.querySelector('.window .content-terminal');
                            if (terminalWindow) {
                                initTerminal(terminalWindow.parentElement);
                            }
                        }, 100);
                    } else {
                        output.innerHTML += `–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –≤ '${args[1]}'.\n`;
                    }
                } else {
                    output.innerHTML += "–£–∫–∞–∂–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.\n";
                }
                break;
                
            case '–≤–∑—è—Ç—å':
                if (args[1]) {
                    if (takeItem(args[1])) {
                        output.innerHTML += `–ü–æ–¥–æ–±—Ä–∞–Ω –ø—Ä–µ–¥–º–µ—Ç: ${args[1]}\n`;
                    } else {
                        output.innerHTML += `–ù–µ –º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å '${args[1]}'.\n`;
                    }
                } else {
                    output.innerHTML += "–£–∫–∞–∂–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç.\n";
                }
                break;
                
            case '–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å':
                output.innerHTML += `–ü—Ä–µ–¥–º–µ—Ç—ã: ${inventory.length > 0 ? inventory.join(', ') : '–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç'}\n`;
                break;
                
            case '–ø–æ–º–æ—â—å':
                output.innerHTML += `
–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
–æ—Å–º–æ—Ç—Ä–µ—Ç—å [–ª–æ–∫–∞—Ü–∏—è/–ø—Ä–µ–¥–º–µ—Ç] - –æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—ä–µ–∫—Ç
–∏–¥—Ç–∏ [–ª–æ–∫–∞—Ü–∏—è] - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –≤ –ª–æ–∫–∞—Ü–∏—é
–≤–∑—è—Ç—å [–ø—Ä–µ–¥–º–µ—Ç] - –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç
–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å - –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
—Å–∏—Å—Ç–µ–º–∞ - —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–ø–æ–º–æ—â—å - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

"–ü–æ–º–æ—â—å? –ó–¥–µ—Å—å –Ω–µ—Ç –ø–æ–º–æ—â–∏. –¢—ã –æ–¥–∏–Ω."
                \n`;
                break;
                
            case '—Å–∏—Å—Ç–µ–º–∞':
                output.innerHTML += `
WINTER SYSTEM v1.0
–°–æ—Å—Ç–æ—è–Ω–∏–µ: ${inventory.length > 3 ? '–°–¢–ê–ë–ò–õ–¨–ù–û' : '–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï'}
–õ–æ–∫–∞—Ü–∏—è: ${currentLocation}
–ü–∞–º—è—Ç—å: ${diaryEntries.length} –∑–∞–ø–∏—Å–µ–π

"–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–∞–∫ –∏ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ."
                \n`;
                break;
                
            default:
                output.innerHTML += `–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: ${command}\n`;
        }
        
        output.scrollTop = output.scrollHeight;
    }

    // ============================ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============================
    document.addEventListener('DOMContentLoaded', () => {
        initMatrix();
        createSnowflakes();
        updateClock();
        
        // –°–æ–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        createWindow('–¢–ï–†–ú–ò–ù–ê–õ –ü–£–°–¢–û–¢–´', 'terminal');
        createWindow('–°–ò–°–¢–ï–ú–ù–´–ô –ê–ù–ê–õ–ò–ó', 'system');
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏
        addDiaryEntry("–°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –•–æ–ª–æ–¥ –ø—Ä–æ–Ω–∏–∫–∞–µ—Ç –≤ –∫–æ—Å—Ç–∏.");
        addDiaryEntry("–ü—Ä–æ—Å–Ω—É–ª—Å—è –≤ –ª–µ–¥—è–Ω–æ–π –ø—É—Å—Ç–æ—Ç–µ. –û–ø—è—Ç—å.");
        addDiaryEntry("–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —è —É–∂–µ –∑–¥–µ—Å—å? –î–Ω–∏, –Ω–µ–¥–µ–ª–∏, –≥–æ–¥—ã? –í—Ä–µ–º—è –ø–æ—Ç–µ—Ä—è–ª–æ —Å–º—ã—Å–ª.");
        
        addSystemLog("SYSTEM_BOOT: WINTER v1.0");
        addSystemLog("USER_SESSION_START: UNKNOWN");
        addSystemLog("REALITY_PROTOCOL: OFFLINE");
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–µ–Ω—é –ü—É—Å–∫
        document.getElementById('start-button').addEventListener('click', (e) => {
            e.stopPropagation();
            const menu = document.querySelector('.start-menu');
            menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
        });
        
        document.addEventListener('click', () => {
            document.querySelector('.start-menu').style.display = 'none';
        });
    });

    function updateClock() {
        const now = new Date();
        const timeString = now.toLocaleTimeString();
        document.getElementById('system-clock').textContent = timeString;
        setTimeout(updateClock, 1000);
    }

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è HTML
    window.createWindow = createWindow;
    window.processCommand = processCommand;
</script>

</body>
</html>